package BubbleSort;

import java.util.ArrayList;
import java.util.List;

public class prueba_3 {

public static void main(String[] args) {

    final int START = 1;      // initial length
    final int END   = 5000;    // final length
    final int STEP  = 2;      // increment per loop
    final int TRIES = 10;     // runs per size

    double lowestTimePerElement = Double.MAX_VALUE;
    double highestTimePerElement = Double.MIN_VALUE;
    int sizeAtLowestTime = -1;
    int sizeAtHighestTime = -1;

    List<String> summary = new ArrayList<>();

    for (int n = START; n <= END; n += STEP) {

        int[] v = new int[n];
        long[] runTimes = new long[TRIES];

        // Run sorting TRIES times
        for (int i = 0; i < TRIES; i++) {
            MetodosA.llenarArrayRandom(v, 1, 99);

            long t1 = System.nanoTime();
            MetodosA.Timsort2.timsort(v,0);
            long t2 = System.nanoTime();

            runTimes[i] = t2 - t1;
        }

        // Compute stats
        long max = runTimes[0];
        long min = runTimes[0];
        long sum = 0;
        for (long time : runTimes) {
            if (time > max) max = time;
            if (time < min) min = time;
            sum += time;
        }
        double avg = sum / (double) TRIES;

        // Convert to milliseconds
        double avgMs = avg / 1_000_000.0;
        double maxMs = max / 1_000_000.0;
        double minMs = min / 1_000_000.0;

        // Compute time per element
        double timePerElement = avgMs / n; // avg ms per array element

        // Track highest and lowest time per element
        if (timePerElement < lowestTimePerElement) {
            lowestTimePerElement = timePerElement;
            sizeAtLowestTime = n;
        }
        if (timePerElement > highestTimePerElement) {
            highestTimePerElement = timePerElement;
            sizeAtHighestTime = n;
        }

        summary.add(String.format("Size: %d | Max: %.3f ms | Min: %.3f ms | Avg: %.3f ms | Time/Element: %.6f ms",
                n, maxMs, minMs, avgMs, timePerElement));
    }

    // Print summary after all runs
    System.out.println("=== Benchmark Summary ===");
    for (String line : summary) {
        System.out.println(line);
    }

    System.out.printf("Lowest time per element: %.6f ms at Size %d%n", lowestTimePerElement, sizeAtLowestTime);
    System.out.printf("Highest time per element: %.6f ms at Size %d%n", highestTimePerElement, sizeAtHighestTime);
}

}
